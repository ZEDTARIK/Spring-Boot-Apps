### 20251114_RevisionSemain — Spring Boot CRUD API (Employees)

This repository contains a minimal RESTful API for managing employees, built with Spring Boot 3, Spring Data JPA, and an in‑memory H2 database. Responses are consistently wrapped in a generic `HttpResponse<T>` object and can be produced/consumed as JSON or XML.

The application seeds two employees on startup and exposes CRUD endpoints under `/api/employees`.


#### Stack
- Language: Java 21
- Frameworks:
  - Spring Boot 3.5.7 (Web, Validation)
  - Spring Data JPA
  - H2 Database (in‑memory, runtime scope)
  - Lombok (compile-time, optional)
  - Jackson (JSON) + Jackson XML
- Build tool / Package manager: Maven (with Spring Boot Maven Plugin)
- Tests: JUnit 5 via `spring-boot-starter-test`


### Requirements
- JDK 21+
- Maven 3.9+ (optional if you use the Maven Wrapper bundled in this repo)
- Java-compatible terminal

On Windows, prefer the wrapper `mvnw.cmd`; on macOS/Linux, use `./mvnw`.


### Getting Started
1. Clone the repository.
2. Build (this will also run tests):
   - Windows: `mvnw.cmd clean package`
   - macOS/Linux: `./mvnw clean package`
3. Run the application:
   - Using Maven:
     - Windows: `mvnw.cmd spring-boot:run`
     - macOS/Linux: `./mvnw spring-boot:run`
   - Using the fat JAR (after packaging):
     - `java -jar target/20251114_RevisionSemain-0.0.1-SNAPSHOT.jar`

By default the server starts at `http://localhost:8080` and uses an in‑memory H2 database that is reset on each restart.


### Entry Point and Initialization
- Main class: `com.ettarak.Application`
- On startup, a `CommandLineRunner` seeds two employees:
  - Name: `Zouhair`, Email: `ettarak@gmail.com`
  - Name: `John`, Email: `John@gmail.com`


### API Endpoints
Base path: `/api/employees`

- GET `/api/employees`
  - Description: Retrieve all employees
  - Produces: `application/json`, `application/xml`

- GET `/api/employees/{id}`
  - Description: Retrieve a single employee by ID
  - Produces: `application/json`, `application/xml`

- POST `/api/employees`
  - Description: Create a new employee
  - Consumes: `application/json`, `application/xml`
  - Produces: `application/json`, `application/xml`
  - Validation: `employeeName` must be non-blank; `employeeEmail` must be a valid email and non-blank

- PUT `/api/employees/{id}`
  - Description: Update employee name and email
  - Consumes: `application/json`, `application/xml`
  - Produces: `application/json`, `application/xml`

- DELETE `/api/employees/{id}`
  - Description: Delete an employee by ID

Responses are wrapped in `HttpResponse<T>` with fields like `timestamp`, `status`, `statusCode`, `message`, `data`, and error fields when applicable.


#### Example Requests
JSON examples (Windows PowerShell quoting shown):

```powershell
# List all
curl -H "Accept: application/json" http://localhost:8080/api/employees

# Get by id
curl -H "Accept: application/json" http://localhost:8080/api/employees/1

# Create
curl -X POST "http://localhost:8080/api/employees" \
     -H "Content-Type: application/json" -H "Accept: application/json" \
     -d '{"employeeName":"Alice","employeeEmail":"alice@example.com"}'

# Update
curl -X PUT "http://localhost:8080/api/employees/1" \
     -H "Content-Type: application/json" -H "Accept: application/json" \
     -d '{"employeeName":"Alice Updated","employeeEmail":"alice.updated@example.com"}'

# Delete
curl -X DELETE http://localhost:8080/api/employees/1
```

XML example:

```bash
curl -H "Accept: application/xml" http://localhost:8080/api/employees
```


### Data Model
Entity: `Employee`
- `id: Long` (PK, generated)
- `employeeCode: String` (UUID generated by Hibernate)
- `employeeName: String` (NotBlank)
- `employeeEmail: String` (NotBlank, Email)
- `createDate: Date` (auto set on persist)
- `updateDate: Date` (auto set on update)
- `deletionDate: Date` (auto set on remove)

Repository: `JpaEmployeeRepository extends JpaRepository<Employee, Long>`


### Error Handling
Global handler: `CustomExceptionHandler`
- Returns `HttpResponse<?>` with `errorMessage` and `developerMessage`
- Notable cases:
  - `EmployeeNotFound` → `404 NOT_FOUND`
  - Validation errors → `400 BAD_REQUEST` (message aggregates validation messages)
  - Other exceptions → `500 INTERNAL_SERVER_ERROR`


### Configuration and Environment
Primary properties in `src/main/resources/application.properties`:

```
server.port=8080
spring.datasource.url=jdbc:h2:mem:db
spring.datasource.username=sa
spring.datasource.password=
spring.h2.console.enabled=true
```

Ways to override at runtime:
- JVM system property: `java -Dserver.port=8081 -jar target/20251114_RevisionSemain-0.0.1-SNAPSHOT.jar`
- Command-line argument: `java -jar target/...jar --server.port=8081`
- Environment variables (per Spring Boot conventions) e.g. `SERVER_PORT=8081`

H2 Console:
- Enabled by default. Default path is typically `/h2-console`.
- TODO: Confirm/adjust H2 console path if a custom path is required (property `spring.h2.console.path`).


### Building, Running, and Scripts
Common Maven wrapper commands:
- Clean: `mvnw.cmd clean` (Windows) or `./mvnw clean`
- Test: `mvnw.cmd test` or `./mvnw test`
- Run: `mvnw.cmd spring-boot:run` or `./mvnw spring-boot:run`
- Package JAR: `mvnw.cmd package` or `./mvnw package`
- Build OCI image (optional): `mvnw.cmd spring-boot:build-image` or `./mvnw spring-boot:build-image`

Generated JAR name (by POM): `target/20251114_RevisionSemain-0.0.1-SNAPSHOT.jar`

Helpful references: see `HELP.md` (auto-generated by Spring Initializr) for links to official docs.


### Tests
- Test framework: JUnit 5 (`@SpringBootTest`)
- To run tests:
  - Windows: `mvnw.cmd test`
  - macOS/Linux: `./mvnw test`

Current test suite contains a context load smoke test: `ApplicationTests.contextLoads()`.


### Project Structure
```
.
├─ pom.xml
├─ HELP.md
├─ src
│  ├─ main
│  │  ├─ java/com/ettarak
│  │  │  ├─ Application.java                      # Spring Boot entry point
│  │  │  ├─ entities/Employee.java                # JPA entity with validation
│  │  │  ├─ repositories/JpaEmployeeRepository.java
│  │  │  ├─ resources/EmployeeResource.java       # REST controller (CRUD)
│  │  │  ├─ services/EmployeeService.java         # Service interface
│  │  │  ├─ services/imp/EmployeeServiceImp.java  # Service implementation
│  │  │  ├─ exceptions/...                        # Global exception handler, domain exceptions
│  │  │  └─ utils/DateTimeFormatter.java          # Timestamp formatting utility
│  │  └─ resources/application.properties         # App config (port, H2, etc.)
│  └─ test/java/com/ettarak/ApplicationTests.java # JUnit 5 smoke test
└─ mvnw / mvnw.cmd                                # Maven Wrapper
```


### License
No license file is present.
- TODO: Add a `LICENSE` file and update `pom.xml` with the correct license metadata.


### Notes
- The database is ephemeral (H2 in‑memory). Data is lost on application restart.
- XML support is enabled via Jackson XML; use appropriate `Accept`/`Content-Type` headers.
